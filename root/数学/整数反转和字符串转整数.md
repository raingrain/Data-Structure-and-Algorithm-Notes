# 整数反转和字符串转整数

## [7. 整数反转](https://leetcode.cn/problems/reverse-integer/)

> - ***Question 1***
>   - 给你一个 `32` 位的有符号整数 `x` ，返回将 `x` 反转后的结果。
>   - 如果反转后整数超过 `32` 位的有符号整数的范围 `[−2^31, 2^31 − 1]` ，就返回 `0` 。
>   - 假设环境不允许存储 `64` 位整数（有符号或无符号）。
>   - ***tips:***
>     - `-2^31 <= x <= 2^31 - 1`

## [8. 字符串转换整数 (atoi)](https://leetcode.cn/problems/string-to-integer-atoi/)

> - ***Question 2***
>   - 请你来实现一个 `myAtoi(string s)` 函数，使其能将字符串转换成一个 `32` 位有符号整数（类似 `C/C++` 中的 `atoi` 函数）。
>   - 函数 `myAtoi(string s)` 的算法如下：
>     1. 读入字符串并丢弃无用的前导空格
>     2. 检查下一个字符（假设还未到字符末尾）为正还是负号，读取该字符（如果有）。确定最终结果是负数还是正数。如果两者都不存在，则假定结果为正。
>     3. 读入下一个字符，直到到达下一个非数字字符或到达输入的结尾。字符串的其余部分将被忽略。
>     4. 将前面步骤读入的这些数字转换为整数（即 `"123" -> 123, "0032" -> 32` ）。如果没有读入数字，则整数为 `0` 。必要时更改符号（从步骤 `2` 开始）。
>     5. 如果整数数超过 `32` 位有符号整数范围 `[−2^31,  2^31 − 1]` ，需要截断这个整数，使其保持在这个范围内。具体来说，小于 `−2^31` 的整数应该被固定为 `−2^31` ，大于 `2^31 − 1` 的整数应该被固定为 `2^31 − 1` 。
>     6. 返回整数作为最终结果。
>   - 注意：
>     - 本题中的空白字符只包括空格字符 ' ' 。
>     - 除前导空格或数字后的其余字符串外，请勿忽略任何其他字符。
>   - ***tips:***
>     - `0 <= s.length <= 200`
>     - `s` 由英文字母（大写和小写）、数字 `0-9`、空格和 `+, -, .` 组成

---

## *Java*

> - ***转成负数反转***

```java
class Solution {
    
    public int reverse(int x) {
        // 看看符号位是不是1
        boolean isNegativeNumber = ((x >>> 31) & 1) == 1;
        // 正数转负数
        x = isNegativeNumber ? x : -x;
        // 系统最小/10
        int quotient = Integer.MIN_VALUE / 10;
        // 系统最小%10
        int remainder = Integer.MIN_VALUE % 10;
        // 记录结果
        int ans = 0;
        while (x != 0) {
            // 你是负数，你比系统最小/10还小，那你乘10越界
            // 你是负数，你等于系统最小/10，但你加上x%10后比系统最小小，那你越界
            if (ans < quotient || (ans == quotient && x % 10 < remainder)) {
                return 0;
            }
            // 正常方法所需步骤
            ans = ans * 10 + x % 10;
            x /= 10;
        }
        // 正数取绝对值
        return isNegativeNumber ? ans : Math.abs(ans);
    }
    
}
```

> - ***用负数转换***
>   - 条件处理有点多，但核心逻辑和 `Question 1` 一样。

```java
class Solution {
    
    public int strToInt(String str) {
        return myAtoi(str);
    }
    
    public int myAtoi(String s) {
        if (s == null || s.equals("")) {
            return 0;
        }
        s = removeHeadZero(s.trim());
        if (s.equals("")) {
            return 0;
        }
        char[] str = s.toCharArray();
        if (!isValid(str)) {
            return 0;
        }
        // 是不是正数
        boolean isPositiveNumber = str[0] != '-';
        int quotient = Integer.MIN_VALUE / 10;
        int remainder = Integer.MIN_VALUE % 10;
        int ans = 0;
        int cur = 0;
        for (int i = (str[0] == '-' || str[0] == '+') ? 1 : 0; i < str.length; i++) {
            // 获取负数
            cur = '0' - str[i];
            if (ans < quotient || (ans == quotient && cur < remainder)) {
                return isPositiveNumber ? Integer.MAX_VALUE : Integer.MIN_VALUE;
            }
            ans = ans * 10 + cur;
        }
        // 正数溢出
        if (isPositiveNumber && ans == Integer.MIN_VALUE) {
            return Integer.MAX_VALUE;
        }
        return isPositiveNumber ? -ans : ans;
    }
    
    private String removeHeadZero(String str) {
        // 有没有正负号位
        boolean hasSign = str.startsWith("+") || str.startsWith("-");
        // 去来到第一个不是0的位置
        int start = hasSign ? 1 : 0;
        for (; start < str.length(); start++) {
            if (str.charAt(start) != '0') {
                break;
            }
        }
        int end = -1;
        for (int i = str.length() - 1; i >= (hasSign ? 1 : 0); i--) {
            if (str.charAt(i) < '0' || str.charAt(i) > '9') {
                end = i;
            }
        }
        // end 到了最左的不是数字字符的位置
        return (hasSign ? String.valueOf(str.charAt(0)) : "") + str.substring(start, end == -1 ? str.length() : end);
    }
    
    // 检查一个字符串内部是否合法
    private boolean isValid(char[] str) {
        // 开头不是符号或者数字
        if (str[0] != '-' && str[0] != '+' && (str[0] < '0' || str[0] > '9')) {
            return false;
        }
        // 字符里面只有符号
        if ((str[0] == '-' || str[0] == '+') && str.length == 1) {
            return false;
        }
        // 中间有不是数字的字符
        for (int i = 1; i < str.length; i++) {
            if (str[i] < '0' || str[i] > '9') {
                return false;
            }
        }
        return true;
    }
    
}
```

---

> ***last change: 2023/4/14***

---

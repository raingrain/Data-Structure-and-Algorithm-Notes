# 图论

## 图的表达、基本概念与分类

- 图是一个三元组 `<V(G),E(G), &Phi;(G)>` ，其中 `V(G)` 是一个非空的结点（也可称为节点、顶点等）集合，`E(G)` 是边集合，`&Phi;(G)` 是从边集合 `E` 到结点无序偶（有序偶）集合上的函数。
- 图根据边是否有方向可分为**有向图**、**无向图**和**混合图**，有向图的边叫做**有向边**或者**弧**。
- 若有 `n` 个节点，就叫做 **`n` 阶图**；若节点数和边数均为有限数，叫做**有限图**；若图中没有边，叫做**零图**，此时如果图还是 `1` 阶图，则叫做**平凡图**。
- 若一个顶点没有任何边关联于它，即该顶点与其他点都不相连，称该顶点为**孤立点**或**孤立顶点**。
- 若一条边的始点和终点是同一顶点，称该边为**环**。连接于同一无序或有序顶点对的多条边称为**平行边**。从同一个节点连接到自己的边叫做**自环边**。
- 含有平行边的图称为**多重图**。一个没有平行边，没有环的图称为**简单图**。
- **赋权图**包括**边赋权图**和**点赋权图**，一般使用边赋权图，此时每一条边或者每一个顶点都会被赋予一个整数值，这个整数值叫做**权值**。
- 如果两个顶点之间有边相邻，我们称这两个顶点是**相邻**的，对于边来说，我们说边与它一端的顶点**关联**。

## 度与度序列

- 与结点关联的边数，称作该结点的**度数**。
- 在有向图中，射入一个节点的边数称为该结点的**入度**，由一个结点射出的边数称为该结点的**出度**，记作。入度与出度之和就是该结点的度数。
- 在无向图中，仅有最大度和最小度。
- 在有向图中，可有最大出度、最小出度、最大入度、最小入度。
- 称度数为 `1` 的顶点为**悬挂顶点**，与它关联的边称为**悬挂边**。度为偶数（奇数）的顶点称为偶度（奇度）顶点。
- **握手定理**：任何无向图中，各顶点度数之和等于边数的两倍。同理在有向图中出度之和等于入度之和等于边数，即有向图也满足握手定理。即对于任意的图，所有顶点的度的总和一定是偶数。
- 在任何图中，奇度顶点的个数是偶数。
- 在顶点数大于等于 `2` 的任意图中都存在不同的两个顶点度数相等。
- 图的**度序列**是指对图中各顶点的度降序排列所得到的序列。
- 如果一个非负整数的降序列可以作为图的度序列，则称这个序列为**可图化**的，也叫做**可图化序列**。
- 使非负整数的降序列 `a1, ..., an` 可图化的充要条件是将 `a2 - 1, a3 - 1, ..., a_{a1 + 1} - 1, a_{a1 + 2}, a_{a1 + 3}, ..., an` 降序重排之后的序列可图化。

## 完全图、子图与补图

- 简单图中，若每一对结点间都有边相连，则称该图为**完全图**。
- 有 `n` 个节点的无向完全图中，对每条边任意确定一个方向，称该图为 `n` 个节点的**有向完全图**。
- `n` 个结点的无向完全图的边数为 `n * (n - 1) / 2` 。
- 设图 `G = <V, E>` 中，如果图 `G' = <V', E'>` 且 `E'` 是 `E` 的子集，`V'` 是 `V` 的子集，则称 `G'` 为 `G` 的**子图**。如果 `V' = V` ，则称 `G'` 是 `G` 的生成子图。
- 给定一个图 `G` ，由 `G` 中所有结点和所有能使 `G` 成为完全图的添加边组成的图，称为 `G` 的相对于完全图的补图。若该补图与 `G` 全等则称 `G` 是自补图。
- 设图 `G' = <V', E'>` 是图 `G = <V, E>` 的子图，若给定另外一个图 `G'' = <V'', E''>` 使得 `E'' = E - E'` ，且 `V''` 中仅包含 `E''` 的边所关联的结点。则称 `G''` 是子图 `G'` 的相对于图 `G` 的补图。

## 图的同构

- 图 `G` 的顶点经过重新编号后可以与图  `G'` 完全相同，则这两个图同构。两图同构的必要条件：
  - 结点数目相同。
  - 边数相等。
  - 度数相同的结点数目相等。

## 路与回路

- 一个节点到另外一个节点所经过的边叫**路**或**通路**，**路的长度**为组成路的边数，一般情况下认为路中所有顶点均不相同。
- 当路的起点和终点为同一个节点时路称作**回路**。
- 若路中所有的边均不相同，但顶点允许重复出现，称作**迹**。
- 若路中所有结点均不相同，称作**通路**。
- 若除起点等于终点以外所有结点均不相同的路称作**圈**，若图中所有顶点的度都大于 `2` ，则图中有圈。
- 在 `n` 阶图中，如果从结点 `vj` 到 `vk` 存在一条路，则必存在一条不多于 `n - 1` 条边的路。在一个具有 `n` 个结点的图中，若从结点 `vj` 到 `vk` 存在一条路，则必存在一条从 `vj` 到 `vk` 不多于 `n - 1` 条边的通路。
- 两个顶点之间的**距离**，是指在以两个顶点位端点的路中的最短路的长度。

## 无向图中的连通图与连通分支

- 在无向图 `G` 中，结点 `u` 和 `v` 之间若存在一条路，则称结点 `u` 和 `v` 是**连通**的。
- 在无向图 `G` 是平凡图或 `G` 中任何两个顶点都是连通的，则称 `G` 为**连通图**，否则称 `G` 是**非连通图**。把无向图中相互连通的点构成的子图称为**连通分支**。

## 无向图的割集

- 无向连通图 `G = <V, E>` 中，若存在 `V1` 是 `V` 的真子集且 `V1` 不是空集，使得 `G` 删除了 `V1` 所有点后所得的子图不连通，而若删除 `V1` 的任何真子集后，所得的子图仍是连通图，则称 `V1` 是 `G` 的一个**点割集**。若 `V1` 中只有一个点，则称为**割点**。
- 无向连通图 `G = <V, E>` 中，若存在 `E1` 是 `E` 的真子集且 `E1` 不是空集，使得 `G` 删除了 `E1` 所有边后所得的子图是不连通图，而若删除了 `E1` 的任何真子集后，所得的子图仍是连通图，则称 `E1` 是 `G` 的一个**边割集**。若 `E1` 中只有一条边，则称为**割边**或**桥**。

## 无向图的连通度

- **点（边）连通度**是为了产生一个不连通图需要删去的点（边）的最少数目。
- 非连通图的点（边）连通度为 `0` 。
- 完全图的点（边）连通度为 `n - 1` 。
- 存在割点（边）的连通图的点（边）连通度为 `1` 。
- 无向图中满足点连通度小于等于边连通度，边连通度小于等于最小度。
- 连通无向图的结点 `v` 是割点的充分必要条件是存在两个结点 `u` 和 `w` ，使得结点 `u` 和 `w` 的每条路都通过 `v` 。

## 有向图的连通

- 有向图中从结点 `u` 到 `v` 有一条路，称从 `u` **可达** `v` 。如果 `u` 可达 `v` ，则在 `u` 到 `v` 的路中最短路得长度称为 `u` 和 `v` 间的距离，记作 `d<u, v>` 。
- 简单有向图中，若任何一对结点间至少有一个结点到另一个结点是可达的，则称图是**单侧连通**的。若图中任何一对结点两者之间是相互可达的，则称图是**强连通**的。如略去边的方向，把有向图看做无向图后，图是连通的，则称图是**弱连通**的。强连通图一定是单向连通图，单向连通图一定是弱连通图。
- **有向图是强连通图当且仅当图中存在经过每个顶点至少一次的回路。**
- 简单有向图中，具有强连通性质的最大子图，称为**强分图**（**有向图中，它的每一个结点位于且只位于一个强分图中**）；具有单侧连通性质的最大子图，称为单侧分图；具有弱连通性质的最大子图，称为弱分图。

## 图的矩阵表示

- **邻接矩阵**：较为熟悉，`aij` 等于 `1` 表示节点 `i` 与节点 `j` 邻接，为 `0` 表示两者之间不邻接。由于邻接矩阵是方阵，按照矩阵运算可以计算它的任意 `n` 阶方阵。则 `k` 阶方阵中的 `i` 行 `j` 列元素等于图中结点 `i` 到结点 `j` 的长度为 `k` 的路的数目， `i` 行 `i` 列元素等于图中结点 `i` 到结点 `i` 的长度为 `k` 的回路的数目。
- **可达矩阵**：`aij` 等于 `1` 表示节点 `i` 与节点 `j` 之间存在路，为 `0` 表示两者之间不存在路。
- **关联矩阵**：行为节点号，列为边号。无向图的关联矩阵中 `aij` 等于 `1` 表示节点 `i` 与边 `j` 关联，为 `0` 表示两者之间不关联。有向图的关联矩阵中 `aij` 等于 `1` 表示节点 `i` 是边 `j` 的起点，等于 `-1` 表示节点 `i` 是边 `j` 的终点，为 `0` 表示两者之间不关联。

## 欧拉图

- 给定无孤立点的无向图，若存在一条路，经过所有边一次且仅一次，称为**欧拉路**；若存在经过图中所有边一次并且仅一次的回路称为**欧拉回路**。具有欧拉回路的图称为**欧拉图**。具有欧拉路而无欧拉回路的图称为**半欧拉图**。
- 给定有向图，通过图中每边一次且仅一次的一条单向路（回路），称作**单向欧拉路**（欧拉回路）。
- 无孤立点的无向图具有一条欧拉路，当且仅当图是连通的，且有零个或两个奇数度结点。
- 连通无向图中两个不相同结点之间存在欧拉路当且仅当图中仅有两个奇数度结点。
- 有向图具有一条单向欧拉回路，当且仅当它是连通的，且每个结点入度等于出度。有向图具有一条单向欧拉路，当且仅当它是连通的，且除两个结点外，每个结点的入度等于出度，但这两个结点中，一个节点的入度比出度大 `1` ，另一个结点的入度比出度小 `1` 。
- 连通图中含有欧拉回路的充要条件是图中所有顶点的度都是偶数。

## 哈密顿图

- 给定图，若存在一条路，经过所有的结点一次且仅一次，称为**哈密顿路**；若存在经过图中所有结点一次并且仅一次的回路称为**哈密顿回路**。具有哈密顿回路的图称为**哈密顿图**。具有哈密顿路但不具有哈密顿回路的图称为**半哈密顿图**。
- 设一个无向图是哈密顿图，对于任意的节点集合，在图中删去这些节点集合所形成的新图的连通分支数不超过集合的节点数。
- 若图中有割点或桥，则图不是哈密顿图。
- 设图为 `n` 阶无向简单图，若对于图中每一对结点两个节点的度数之和大于等于节点数减一 `n - 1` ，则图中存在哈密顿通路。
- **奥尔定理**：设图为 `n (n >= 3)` 阶无向简单图，若对于图中任意两个不相邻的顶点均有两个顶点的度数之和大于等于 `n` ，即任意一个顶点的度数大于等于 `n / 2` ，则图中存在哈密顿回路，从而图为哈密顿图。
- **狄拉克定理**：设图为 `n (n >= 3)` 阶无向简单图，若对于图中任意一个顶点的度数大于等于 `n / 2` ，则图中存在哈密顿回路，从而图为哈密顿图。

## 平面图

- 如果能够把图的所有结点和边画在平面上，且使得任何两条边除了端点外没有其他的交点，就称该图是一个**平面图**。
- 设图是一个连通平面图，由图中的边所包围的区域称为图的一个**面**，其中面中包含结点和边。包围该面的各条边构成的回路称为面的**边界**。
- 一个有限平面图，面的次数之和等于其边数的两倍。
- 设有一个连通的平面图，内含有 `n` 个结点、`m` 条边和 `r` 块面，则**欧拉公式**成立，有 `n - m + r = 2` 。
- 任何一个简单的连通平面图，内含有 `n` 个结点、`m` 条边，则有 `m <= 3 * n - 6` 。
- 两个图称为**同胚**，即为在二度顶点内同构，若在这两个图中加上或去掉一些 `2` 度顶点后，两个新图是同构的。
- **库拉托夫斯基定理**：即一个图是平面图的充分必要条件是这一图不包含任何同胚于 `K5` 或 `K3,3` 的子图。

## 平面图的着色

- 对平面图的所有顶点进行着色，使相邻顶点的颜色不一样所需的最少颜色数为**点着色**。
- 对平面图的所有边进行着色时，使相邻边的颜色不一样所需的最少颜色数为**边着色**。
- 对平面图的所有面进行着色时，使相邻面的颜色不一样所需的最少颜色数为**面着色**。

## 对偶图

- 图 `G'` 是 `G` 的**对偶图**，需要满足以下条件：
  - 图 `G` 中的每一个面只含有 `G'` 的一个节点；
  - 图 `G` 中面的公共边界，图 `G'` 中有且仅有一条边于其相交。
  - 图 `G` 中一个边仅是一个面的边界时，图 `G'` 中有一条环于其相交。
- 若图 `G'` 是 `G` 的对偶图且与图 `G` 同，则称 `G` 为**自对偶图**。

## 对偶图的着色

- 对于 `n` 个结点的完全图，有点着色数量等于 `n` 。
- 设图为一个至少有三个结点的连通平面图，则图中必有一个结点的度数小于等于 `5` 。

## 五色定理

- 任意一个简单的连通平面图点着色至多五色。

## 韦尔奇·鲍威尔（WelchPowell）着色法

1. 将图中的顶点按度数递减次序排列。
2. 用第一种颜色对第一顶点着色，并将与已着色顶点不邻接的顶点也着第一种颜色。
3. 按排列次序用第二种颜色对未着色的顶点重复 `2` 。用第三种颜色继续以上做法，直到所有的顶点均着上色为止。

## 无向树

- 一个连通且无回路的无向图称为**树**，简记 `T` 。树中度数为 `1` 的结点称为**树叶**，度数大于 `1` 的结点称为**分枝点**或**内点**。一个无回路的无向图称作**森林**，它的每个连通分图是树。给定图T，以下是树的等价定义：
  - 无回路的连通图。
  - 无回路且边数等于节点数减一。
  - 连通且且边数等于节点数减一。
  - 无回路，但增加一条新边，得到一个且仅有一个回路。
  - 连通，但删去任一边后便不连通。
  - 每一对结点之间有一条且仅有一条路。
- 结点数大于 `1` 的树中至少有两片树叶。
- `n` 个顶点的树的边数为 `n - 1` 。

## 无向生成树与最小无向生成树

- 若图的生成子图是一棵树，则该树称为的**生成树**。生成树中的边称为**树枝**。图中不在树中的边称为**弦**。所有弦的集合称作生成树的**补**。
- 连通图至少有一棵生成树。
- 一条回路和任何一棵生成树的补至少有一条公共边。
- 一个边割集和任何生成树至少有一条公共边。
- 设 `G` 是具有 `n` 个结点的连通图。对应于 `G` 的每一条边 `e` ，制定一个正数作为边 `e` 的权。`G` 的生成树 `T` 也有一个树权，它是 `T` 的所有边权的和。在图 `G` 的所有生成树中，树权最小的那棵生成树，称作**最小生成树**。

## 有向树

- 如果一个有向图在不考虑边的方向时是一棵树，则这个有向图称为**有向树**。
- 一棵有向树，如果恰有一个节点的入度为 `0` ，其余所有结点的入度都为 `1` ，则称为**根树**。入度为 `0` 的结点称为**根**，出度为 `0` 的结点称为**叶**，出度不为 `0` 的结点称为**分枝点**或**内点**。
- 在根树中，若每个结点的出度小于或等于 `m` ，则称这棵树为 **`m` 叉树**。如果每一个结点的出度恰好等于 `m` 或 `0` ，则称这棵树为**完全 `m` 叉树**；若其所有树叶层次相同，称为**正则 `m` 叉树**。当 `m = 2` 时，称为**二叉树**。
- 完全 `m` 叉树的树叶数为 `t` ，分枝点数为 `i` ，则 `(m - 1) * i = t - 1` 。
- 一棵完全二叉树必有奇数个顶点。
- 根树中一个结点的**通路长度**是从根到此结点的通路的边数。把分枝点的通路长度称为**内部通路长度**，树叶的通路长度称为**外部通路长度**。
- 若完全二叉树有 `n` 个分枝点，内部通路长度总和为 `I` ，外部通路长度总和为 `E` ，则 `E = I + 2 * n` 。
- 在带权二叉树中，若带权为 `wi` 的树叶，其通路长度为 `L(wi)` ，把 `w(T) = sum(wi * L(wi))` 称为该带权二叉树的权。在所有带权的二叉树中，权值最小的那棵树，称为**最优树**。
- 设 `T` 为带权 `w1 <= w2 <= ... <= wt` 的最优树，则带权 `w1, w2` 的树叶 `vw1, vw2` 是兄弟；以树叶 `vw1, vw2` 为儿子的分枝点，通路长度最长。
- 设 `T` 为带权 `w1 <= w2 <= ... <= wt` 的最优树，若将以带权 `w1` 和 `w2` 的树叶为儿子的分枝点改为带权为 `w1 + w2` 的树叶，得到一棵新树 `T'` ，则 `T'` 也是最优树。
- 霍夫曼（Huffman）算法求最优树，给定实数 `w1 <= w2 <= ... <= wt` ：
  1. 连接权为 `w1, w2` 的两片树叶，得一个分支点，其权为 `w1 + w2` 。
  2. 在 `w1 + w2, w3, ..., wt` 中选出两个最小的权，连接它们对应的顶点（不一定是树叶），得新分支点及所带的权。
  3. 重复 `2` ，直到形成 `t - 1` 个分支点、`t` 片树叶为止。

## 二部图

- 若图 `G = (V, E)` 的顶点集合 `V` 可以划分成满足以下条件的 `V1` 和 `V2` ：在 `E` 中，不存在两个端点同在 `V1` 中或同在 `V2` 中的边，则 `G` 为**二部图**。即 `E` 中的任何一条边都是由 `V1` 中的一点和 `V2` 中的一点连结而成的。树是二部图。
- 在二部图中，若 `V1` 和 `V2` 之间的所有顶点对都有边相连，则称该二部图为**完全二部图**。完全二部图的边数为两个点集的元素数相乘。
- 若图 `G = (V, E)` 的顶点集合 `V` 可以划分成满足以下条件的 `V1, V2, ..., Vk` ：在 `E` 中，对于每一个 `i` 不存在两个端点同在 `Vi (i <= i <= k)` 中的边，则 `G` 为 **k部图**。顶点数为 `n` 的图为n部图，n部图也是n + 1部图。

## 正则图

- 所有顶点的度都相等的图叫做**正则图**。
- 所有顶点的度都等于 `k` 的图叫做**k-正则图**。
- `n` 个顶点的k-正则图的边数为 `n * k / 2` 。
- `n` 个顶点的完全图是(n - 1)-正则图。

## 前缀码

- 给定一个序列的集合，若没有一个序列是另一个序列的前缀，该序列集合称为**前缀码**。
- 任意一棵二叉树的树叶可对应一个前缀码。
- 任何一个前缀码都对应一棵二叉树。

## 最小斯坦纳树

- 给定一个图和这个图的的所有节点集合的一个子集，子集中的节点叫做**终端节点**，这个子集的最小生成树即为**最小斯坦纳树**。

## 最大流问题

- 给定弧上赋权的有向图 `D = (V, A)` ，这里的权值均为整数。在 `V` 中有两个特殊的顶点，一个是**源点 `s`** ，另一个是**汇点 `t`** 。我们可以把弧 `e` 上的权值 `w(e)` 理解为该弧（**管道**）的粗细，即沿着这条弧的方向只有 `w(e)` 这么多的液体可以流过去。这时，从 `s` 往 `t` 的方向最多能让多少液体流过去的问题称为**最大流问题**，流量最大的流叫做**最大流**。在最大流问题中，我们将弧的权值称为**容量**。
- 最大流问题的数学定义如下。作为问题的输入，我们需要给出上述有向图 `D = (V, A)` 、顶点 `s` 和顶点 `t` ，以及各弧的容量 `w(e)` 。定义一个函数 `f` ，为每条弧指定一个实数值，若函数满足以下条件，则称之为流。函数值 `f(e)` 表示通过弧 `e` 的**液体流量**。
  - 条件 `1` 容量限制原则：对所有的弧 `e` ，有 `f(e) <= w(e)` ，即各弧上的流量不能超过其容量。
  - 条件 `2` 流量守恒原则：对于 `s` 、 `t` 以外的任意顶点 `v` ，都有流入的流量等于流出的流量。
  - 条件 `3` ：源点流出的流量等于汇点流入的流量。
- 将图 `D = (V, A)` 作为最大流问题的输入，我们将包含源点但不包含汇点的 `V` 的子集 `Y` 叫做 `D` 的**割**。而**割边**是从 `Y` 指向外部的弧。割 `Y` 的**容量**或者**大小**是指 `Y` 的割边的权值总和。图 `D` 中容量最小的割是图 `D` 的**最小割**。
- **最大流最小割定理**：对于任意的图都有最大流的流量等于最小割的容量。

## 无向图的匹配

- 设 `M` 为图 `G = (V, E)` 的边集合的子集，即 `M` 是 `E` 的子集。如果 `M` 中的任意两条边都没有共同顶点，我们则称 `M` 为 `G` 的一个**匹配**。只有一条边构成的集合甚至空集合也是一个匹配。
- 匹配主要应用于二部图。对于二部图 `G = (U, V, E)` ，比如说，用 `U` 中的顶点表示员工，用 `V` 中的顶点表示工作。当员工 `u` 可以担任工作 `v` 时，有 `(u, v)` 属于 `E` 。假设每个人不能同时承担两份工作，并且每份工作只要一个人就够了。在这种情况下，图 `G` 中的匹配就对应了在满足上述条件下给员工分配工作的方案。再比如，用 `U` 中的顶点表示男生，用 `V` 中的顶点表示女生。如果认为男生 `u` 和女生 `v` 可以交往，就有 `(u, v)` 属于 `E` 。这时，图 `G` 中的匹配就相当于情侣的集合。
- 如果某顶点与 `M` 中的边相关联，我们说该顶点被**匹配**。`M` 中边的条数称为 `M` ，用 `|M|` 来表示。
- 对于 `G = (V, E)` 的匹配 `|M|` ，如果向 `M` 中添加 `E - M` 中的任何一条边都能使之变为**非匹配**，我们则称 `M` 是**极大匹配**。如果 `M` 是 `G` 的所有匹配中边数最大的，我们则称 `M` 是**最大匹配**。最大匹配一定是极大匹配，反过来却不一定。
- 任意极大匹配的大小不小于最大匹配大小的一半。
- 如果所有顶点都被匹配到了，我们则称该匹配为**完美匹配**，则 `|M| = |V| / 2` 。
- 在原理的二部图 `G = (U, V, E)` 的基础上按照以下要求进行改造，构造出最大流问题中的有向图 `D` ：
  - `D` 是边赋权的有向图，权值表示容量。
  - `D` 的顶点集合为 `G` 的顶点集合 `U` 、 `V` 加上源点 `s` 和汇点 `t` 所形成的集合。
  - 从 `s` 出发到 `U` 中的每个顶点都连上一条弧。从 `V` 中的每个顶点出发到 `t` 都连上一条弧。
  - `U` 和 `V` 之间的弧集合与 `G` 的边集合 `E` 相同，并且弧的方向全部是从 `U` 指向 `V` 。
  - 弧的容量全部为 `1` 。
- `G` 中最大匹配的大小和 `D` 中最大流的流量相等。

---

> ***last change: 2023/7/10***

---
